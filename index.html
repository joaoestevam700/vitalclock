<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VitalClock - Gerenciador de Tempo de Vida</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Inter',sans-serif;background:linear-gradient(135deg,#667eea,#764ba2);min-height:100vh;color:#1f2937}.container{max-width:1200px;margin:0 auto;padding:20px}.nav{position:fixed;top:0;left:0;right:0;background:rgba(255,255,255,.98);backdrop-filter:blur(10px);box-shadow:0 4px 6px rgba(0,0,0,.1);z-index:100;padding:15px 20px;display:flex;justify-content:space-between;align-items:center}.logo{display:flex;align-items:center;gap:12px;font-size:24px;font-weight:800;color:#2c5282;cursor:pointer;text-decoration:none}.logo-img{width:40px;height:40px}.btn{padding:12px 24px;border:none;border-radius:12px;font-weight:600;cursor:pointer;transition:.3s;display:inline-flex;align-items:center;gap:8px}.btn-primary{background:linear-gradient(135deg,#2563eb,#7c3aed);color:white;box-shadow:0 4px 6px rgba(0,0,0,.1)}.btn-primary:hover{transform:translateY(-2px);box-shadow:0 10px 15px rgba(0,0,0,.15)}.btn-secondary{background:white;color:#2563eb;border:2px solid #2563eb}.btn-success{background:linear-gradient(135deg,#10b981,#14b8a6);color:white}.card{background:white;border-radius:24px;padding:32px;box-shadow:0 20px 25px rgba(0,0,0,.1);margin-bottom:20px}.hero{min-height:100vh;display:flex;align-items:center;justify-content:center;text-align:center;padding:100px 20px 40px;background:linear-gradient(135deg,rgba(37,99,235,.95),rgba(124,58,237,.95))}.hero-title{font-size:clamp(2.5rem,6vw,4rem);font-weight:900;color:white;margin:20px 0;text-shadow:2px 2px 4px rgba(0,0,0,.2)}.hero-subtitle{font-size:1.25rem;color:white;margin-bottom:30px;max-width:700px;text-shadow:1px 1px 2px rgba(0,0,0,.2)}.input{width:100%;padding:12px 16px;border:2px solid #e5e7eb;border-radius:12px;font-size:16px;margin-bottom:16px;transition:.2s}.input:focus{outline:none;border-color:#2563eb;box-shadow:0 0 0 3px rgba(37,99,235,.1)}.label{font-weight:600;font-size:14px;color:#374151;margin-bottom:8px;display:block}.range{width:100%;height:8px;border-radius:999px;background:#e5e7eb;outline:none;-webkit-appearance:none}.range::-webkit-slider-thumb{-webkit-appearance:none;width:24px;height:24px;border-radius:50%;background:#2563eb;cursor:pointer;box-shadow:0 4px 6px rgba(0,0,0,.1)}.range::-moz-range-thumb{width:24px;height:24px;border-radius:50%;background:#2563eb;cursor:pointer;border:none}.progress{width:100%;height:12px;background:#e5e7eb;border-radius:999px;overflow:hidden;margin:20px 0}.progress-bar{height:100%;background:linear-gradient(90deg,#2563eb,#7c3aed);border-radius:999px;transition:.3s}.modal{position:fixed;inset:0;background:rgba(0,0,0,.6);backdrop-filter:blur(4px);display:flex;align-items:center;justify-content:center;z-index:1000;padding:20px}.modal-content{background:white;border-radius:24px;max-width:900px;width:100%;max-height:90vh;overflow-y:auto;box-shadow:0 25px 50px rgba(0,0,0,.25)}.modal-header{display:flex;justify-content:space-between;align-items:center;padding:24px;border-bottom:1px solid #e5e7eb}.modal-body{padding:24px}.modal-close{width:40px;height:40px;border-radius:50%;border:none;background:#f3f4f6;color:#6b7280;font-size:24px;cursor:pointer;transition:.2s}.modal-close:hover{background:#e5e7eb;transform:rotate(90deg)}.grid{display:grid;gap:24px}.grid-2{grid-template-columns:repeat(auto-fit,minmax(300px,1fr))}.grid-3{grid-template-columns:repeat(auto-fit,minmax(250px,1fr))}.hidden{display:none!important}.chatbot{position:fixed;bottom:20px;right:20px;z-index:999}.chatbot-btn{width:60px;height:60px;border-radius:50%;background:linear-gradient(135deg,#2563eb,#7c3aed);color:white;border:none;font-size:24px;cursor:pointer;box-shadow:0 10px 15px rgba(0,0,0,.1)}.chatbot-btn:hover{transform:scale(1.1)}.chatbot-window{position:absolute;bottom:80px;right:0;width:350px;height:500px;background:white;border-radius:24px;box-shadow:0 25px 50px rgba(0,0,0,.25);display:flex;flex-direction:column;overflow:hidden}.chatbot-header{background:linear-gradient(135deg,#2563eb,#7c3aed);color:white;padding:16px;display:flex;justify-content:space-between;align-items:center}.chatbot-messages{flex:1;overflow-y:auto;padding:16px;display:flex;flex-direction:column;gap:12px}.chat-msg{max-width:80%;padding:12px 16px;border-radius:12px;animation:fadeIn .3s}.chat-user{align-self:flex-end;background:#2563eb;color:white;border-bottom-right-radius:4px}.chat-bot{align-self:flex-start;background:#f3f4f6;color:#1f2937;border-bottom-left-radius:4px}.chatbot-input-container{padding:16px;border-top:1px solid #e5e7eb;display:flex;gap:8px}.chatbot-input{flex:1;padding:12px;border:1px solid #e5e7eb;border-radius:12px;font-size:14px}.animate-fade{animation:fadeIn .3s ease-out}@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes bounce{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}.bounce{animation:bounce 2s infinite}.toast{position:fixed;top:20px;right:20px;background:white;padding:16px 24px;border-radius:12px;box-shadow:0 10px 15px rgba(0,0,0,.1);z-index:2000;animation:fadeIn .3s}.toast-success{border-left:4px solid #10b981}.toast-error{border-left:4px solid #ef4444}.weather-widget{background:rgba(255,255,255,.15);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.3);border-radius:16px;padding:20px;color:white;margin-top:40px}@media(max-width:768px){.hero-title{font-size:2.5rem}.grid-2,.grid-3{grid-template-columns:1fr}.chatbot-window{width:calc(100vw - 40px);right:20px}}
</style>
</head>
<body>
<nav class="nav"><a class="logo" onclick="setPage('landing')"><img src="https://i.ibb.co/ZMqLjM3/vital-Clock.png" alt="VitalClock" class="logo-img"><span style="color:#2c5282">Vital</span><span style="color:#10b981">Clock</span></a><button class="btn btn-primary" onclick="setPage('login')">ComeÃ§ar</button></nav>
<div id="app"></div>
<div class="chatbot"><button class="chatbot-btn" onclick="toggleChat()">ğŸ’¬</button><div class="chatbot-window hidden" id="chatWindow"><div class="chatbot-header"><h3>Assistente VitalClock IA</h3><button class="modal-close" onclick="toggleChat()">Ã—</button></div><div class="chatbot-messages" id="chatMsgs"><div class="chat-msg chat-bot">OlÃ¡! ğŸ‘‹ Sou seu assistente de saÃºde. Como posso ajudar vocÃª hoje?</div></div><div class="chatbot-input-container"><input type="text" class="chatbot-input" id="chatInput" placeholder="Digite sua pergunta..." onkeypress="if(event.key==='Enter')sendChat()"><button class="btn btn-primary" style="padding:8px 16px" onclick="sendChat()">Enviar</button></div></div></div>
<script>
const healthStats={country:'Brasil',avgLife:76.6,healthyLife:66.2,causes:['DoenÃ§as cardiovasculares (30%)','CÃ¢ncer (17%)','Diabetes (5%)','DoenÃ§as respiratÃ³rias (12%)','Causas externas (6%)'],tips:['Pratique 150min de exercÃ­cio por semana','Consuma 5 porÃ§Ãµes de frutas/vegetais por dia','Durma 7-9 horas por noite','Reduza sal e aÃ§Ãºcar','Mantenha peso saudÃ¡vel','NÃ£o fume','Controle o estresse']};
let state={page:'landing',user:null,data:{name:'',email:'',age:'',gender:'',sleep:'7',exercise:'3',diet:'balanced',smoking:'no',alcohol:'moderate',stress:'5',screenTime:'4'},life:null,step:1},weather=null,countdownInterval=null;
function DB(){return{saveUser:(u)=>{try{let users=JSON.parse(localStorage.getItem('vc_users')||'{}');users[u.email]=u;localStorage.setItem('vc_users',JSON.stringify(users));return true}catch(e){return false}},getUser:(email)=>{try{let users=JSON.parse(localStorage.getItem('vc_users')||'{}');return users[email]||null}catch(e){return null}},saveSession:()=>{try{localStorage.setItem('vc_session',JSON.stringify(state));return true}catch(e){return false}},loadSession:()=>{try{const s=localStorage.getItem('vc_session');return s?JSON.parse(s):null}catch(e){return null}},clearSession:()=>{localStorage.removeItem('vc_session')}}}
const db=DB();
function toast(msg,type='info'){const t=document.createElement('div');t.className=`toast toast-${type} animate-fade`;t.textContent=msg;document.body.appendChild(t);setTimeout(()=>t.remove(),3000)}
function calcLife(d){let b=d.gender==='male'?76:81,f=[];if(d.sleep<6){b-=5;f.push({h:'Sono insuficiente (<6h)',i:-5,r:'Durma 7-8h por noite'})}else if(d.sleep>=7&&d.sleep<=8){b+=3;f.push({h:'Sono adequado (7-8h)',i:3,r:'Continue assim!'})}if(d.exercise>=4){b+=4;f.push({h:'ExercÃ­cio regular (4+ dias)',i:4,r:'Excelente!'})}else if(d.exercise<=1){b-=3;f.push({h:'Sedentarismo (â‰¤1 dia)',i:-3,r:'Caminhe 30min 3x/semana'})}if(d.diet==='healthy'){b+=3;f.push({h:'AlimentaÃ§Ã£o saudÃ¡vel',i:3,r:'Mantenha!'})}else if(d.diet==='poor'){b-=4;f.push({h:'Dieta inadequada',i:-4,r:'Mais frutas/vegetais'})}if(d.smoking==='yes'){b-=10;f.push({h:'Tabagismo ativo',i:-10,r:'Parar pode adicionar 10 anos!'})}if(d.alcohol==='heavy'){b-=5;f.push({h:'Ãlcool excessivo',i:-5,r:'Reduza para 2x/semana'})}else if(d.alcohol==='none'){b+=2;f.push({h:'NÃ£o consome Ã¡lcool',i:2,r:'Ã“tima escolha!'})}if(d.stress>=8){b-=4;f.push({h:'Estresse elevado',i:-4,r:'Pratique meditaÃ§Ã£o'})}else if(d.stress<=3){b+=2;f.push({h:'Baixo estresse',i:2,r:'Continue assim!'})}if(d.screenTime>=8){b-=2;f.push({h:'Muito tempo em telas',i:-2,r:'FaÃ§a pausas'})}return{exp:Math.max(50,Math.min(100,Math.round(b))),factors:f}}
async function fetchWeather(){try{const res=await fetch('https://wttr.in/Campinas?format=j1');const data=await res.json();weather={temp:data.current_condition[0].temp_C,desc:data.current_condition[0].weatherDesc[0].value,humidity:data.current_condition[0].humidity,city:'Campinas, SP'}}catch(e){weather={temp:'25',desc:'Ensolarado',humidity:'60',city:'Campinas, SP'}}}
function setPage(p){state.page=p;db.saveSession();render()}
function render(){const app=document.getElementById('app');if(state.page==='landing'){app.innerHTML=`<div class="hero"><div><div style="margin-bottom:30px"><img src="https://i.ibb.co/ZMqLjM3/vital-Clock.png" alt="VitalClock" style="width:150px;height:150px;animation:bounce 2s infinite"></div><h1 class="hero-title">Quanto Tempo VocÃª Realmente Tem?</h1><p class="hero-subtitle">Descubra como seus hÃ¡bitos impactam sua expectativa de vida com inteligÃªncia artificial. Uma inovaÃ§Ã£o para um futuro mais saudÃ¡vel e sustentÃ¡vel.</p><button class="btn btn-primary" style="padding:16px 32px;font-size:18px" onclick="setPage('login')">ComeÃ§ar AnÃ¡lise Gratuita ğŸš€</button>${weather?`<div class="weather-widget"><div style="display:flex;align-items:center;gap:16px;justify-content:center"><div style="font-size:3rem">â˜€ï¸</div><div><div style="font-size:2rem;font-weight:800">${weather.temp}Â°C</div><div style="opacity:.9">${weather.desc}</div><div style="font-size:.875rem;opacity:.8">${weather.city}</div></div></div></div>`:''}</div></div><section class="container"><h2 style="text-align:center;font-size:2.5rem;font-weight:800;margin-bottom:60px;color:white;text-shadow:2px 2px 4px rgba(0,0,0,.3)">âœ¨ Como Funciona</h2><div class="grid grid-3"><div class="card" style="text-align:center"><div style="font-size:4rem;margin-bottom:16px">ğŸ“Š</div><h3 style="font-weight:700;font-size:1.5rem;margin-bottom:12px;color:#2563eb">Analise</h3><p style="color:#6b7280">Responda sobre seus hÃ¡bitos de vida</p></div><div class="card" style="text-align:center"><div style="font-size:4rem;margin-bottom:16px">â±ï¸</div><h3 style="font-weight:700;font-size:1.5rem;margin-bottom:12px;color:#7c3aed">Visualize</h3><p style="color:#6b7280">RelÃ³gio de vida em tempo real</p></div><div class="card" style="text-align:center"><div style="font-size:4rem;margin-bottom:16px">ğŸ¯</div><h3 style="font-weight:700;font-size:1.5rem;margin-bottom:12px;color:#10b981">Melhore</h3><p style="color:#6b7280">Ganhe anos de vida saudÃ¡vel</p></div></div><div class="card" style="background:linear-gradient(135deg,#2563eb,#7c3aed);color:white;text-align:center;margin-top:40px"><h3 style="font-weight:800;font-size:2rem;margin-bottom:16px">ğŸŒ± InovaÃ§Ã£o Paulista</h3><p style="font-size:1.125rem;opacity:.95">Criando o Futuro SustentÃ¡vel e Inclusivo da Nossa RegiÃ£o</p></div></section>`}else if(state.page==='login'){app.innerHTML=`<div style="min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px"><div class="card animate-fade" style="max-width:500px;width:100%"><div style="text-align:center;margin-bottom:24px"><img src="https://i.ibb.co/ZMqLjM3/vital-Clock.png" alt="VitalClock" style="width:80px;height:80px;margin-bottom:12px"><h2 style="font-weight:800;font-size:2rem;color:#2c5282">VitalClock</h2><p style="color:#6b7280;margin-top:8px">Seu tempo comeÃ§a agora</p></div><div style="display:flex;gap:8px;margin-bottom:24px;background:#f3f4f6;padding:4px;border-radius:999px"><button class="btn" id="loginTab" style="flex:1;padding:8px;background:white;color:#2563eb;box-shadow:0 4px 6px rgba(0,0,0,.1)" onclick="switchTab('login')">Login</button><button class="btn" id="regTab" style="flex:1;padding:8px;background:transparent;color:#374151;box-shadow:none" onclick="switchTab('register')">Cadastro</button></div><form onsubmit="handleAuth(event)" id="authForm"><div id="nameField" style="display:none"><label class="label">Nome Completo</label><input type="text" class="input" id="authName" placeholder="Seu nome"></div><div><label class="label">Email</label><input type="email" class="input" id="authEmail" placeholder="seu@email.com" required></div><div><label class="label">Senha</label><input type="password" class="input" id="authPass" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢" required></div><button type="submit" class="btn btn-primary" style="width:100%">Entrar</button></form><button onclick="setPage('landing')" style="margin-top:16px;background:none;border:none;color:#6b7280;cursor:pointer;width:100%">â† Voltar</button></div></div>`}else if(state.page==='quest'){app.innerHTML=`<div style="min-height:100vh;padding:100px 20px 40px"><div class="container" style="max-width:800px"><div class="card animate-fade"><div style="margin-bottom:32px"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:16px"><h2 style="font-weight:800;font-size:2rem">Conte sobre vocÃª</h2><span style="color:#2563eb;font-weight:600">Passo ${state.step}/4</span></div><div class="progress"><div class="progress-bar" style="width:${(state.step/4)*100}%"></div></div></div><div id="questContent"></div><div style="display:flex;justify-content:space-between;margin-top:32px;gap:16px"><button class="btn btn-secondary" onclick="prevStep()">â† Voltar</button><button class="btn ${state.step<4?'btn-primary':'btn-success'}" onclick="nextStep()">${state.step<4?'PrÃ³ximo â†’':'Ver Resultados ğŸ¯'}</button></div></div></div></div>`;renderQuest()}else if(state.page==='dash'){app.innerHTML=`<div style="min-height:100vh;padding:100px 20px 40px"><div class="container"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:32px;flex-wrap:wrap;gap:16px"><h1 style="font-weight:800;font-size:2.5rem;color:white;text-shadow:2px 2px 4px rgba(0,0,0,.3)">OlÃ¡, ${state.user?.name||'UsuÃ¡rio'}! ğŸ‘‹</h1><div style="display:flex;gap:12px;flex-wrap:wrap"><button class="btn btn-primary" onclick="openEditHabits()">âœï¸ Atualizar HÃ¡bitos</button><button class="btn btn-secondary" onclick="logout()">Sair</button></div></div><div class="grid grid-2"><div class="card animate-fade" style="background:linear-gradient(135deg,#2563eb,#7c3aed);color:white"><h2 style="font-weight:800;font-size:2rem;margin-bottom:16px">â° Seu RelÃ³gio de Vida</h2><div style="text-align:center;padding:32px 0"><div style="font-size:4.5rem;font-weight:800;margin-bottom:16px">${state.life.exp} anos</div><div style="font-size:1.25rem;opacity:.9;margin-bottom:32px">Expectativa de vida estimada</div><div id="countdown" style="font-size:.9rem"></div></div></div><div class="card animate-fade"><h2 style="font-weight:800;font-size:1.5rem;margin-bottom:24px">ğŸ“Š Impacto dos Seus HÃ¡bitos</h2><div id="factors"></div><button class="btn btn-success" style="width:100%;margin-top:24px" onclick="openSimulator()">ğŸ”„ Simular MudanÃ§as</button></div></div><div class="card animate-fade" style="margin-top:24px"><h2 style="font-weight:800;font-size:1.75rem;margin-bottom:24px">ğŸ“ˆ Dados de SaÃºde PÃºblica - ${healthStats.country}</h2><div class="grid grid-2"><div><h3 style="font-weight:700;margin-bottom:12px;color:#2563eb">Expectativa MÃ©dia</h3><div style="font-size:3rem;font-weight:800;color:#7c3aed;margin-bottom:8px">${healthStats.avgLife} anos</div><div style="font-size:1.25rem;font-weight:700;color:${state.life.exp>healthStats.avgLife?'#10b981':'#f59e0b'}">${state.life.exp>healthStats.avgLife?'âœ… VocÃª estÃ¡ acima':'âš ï¸ VocÃª estÃ¡ abaixo'} da mÃ©dia!</div></div><div><h3 style="font-weight:700;margin-bottom:12px;color:#2563eb">Causas de Morte</h3><ul style="list-style:none;padding:0">${healthStats.causes.map(c=>`<li style="padding:8px 0;border-bottom:1px solid #e5e7eb">â€¢ ${c}</li>`).join('')}</ul></div></div><div style="margin-top:24px"><h3 style="font-weight:700;margin-bottom:12px;color:#2563eb">ğŸ’¡ RecomendaÃ§Ãµes da OMS</h3><div class="grid grid-3">${healthStats.tips.map(t=>`<div style="background:#f9fafb;padding:16px;border-radius:12px;border-left:4px solid #10b981"><p style="font-size:.9rem;color:#374151">${t}</p></div>`).join('')}</div></div></div></div></div>`;renderDash()}}
function switchTab(type){document.getElementById('loginTab').style.background=type==='login'?'white':'transparent';document.getElementById('loginTab').style.color=type==='login'?'#2563eb':'#374151';document.getElementById('regTab').style.background=type==='register'?'white':'transparent';document.getElementById('regTab').style.color=type==='register'?'#2563eb':'#374151';document.getElementById('nameField').style.display=type==='register'?'block':'none'}
function renderQuest(){const c=document.getElementById('questContent');if(state.step===1)c.innerHTML=`<h3 style="font-weight:700;font-size:1.5rem;margin-bottom:24px">ğŸ“‹ InformaÃ§Ãµes BÃ¡sicas</h3><label class="label">Idade</label><input type="number" class="input" value="${state.data.age}" oninput="state.data.age=this.value;db.saveSession()" placeholder="Ex: 30" min="1" max="120"><label class="label">Sexo BiolÃ³gico</label><div class="grid grid-2"><button type="button" class="btn ${state.data.gender==='male'?'btn-primary':'btn-secondary'}" onclick="state.data.gender='male';db.saveSession();render()">Masculino</button><button type="button" class="btn ${state.data.gender==='female'?'btn-primary':'btn-secondary'}" onclick="state.data.gender='female';db.saveSession();render()">Feminino</button></div>`;else if(state.step===2)c.innerHTML=`<h3 style="font-weight:700;font-size:1.5rem;margin-bottom:24px">ğŸ˜´ Sono e Descanso</h3><label class="label">Horas de sono: <strong style="color:#2563eb;font-size:1.25rem">${state.data.sleep}h</strong></label><input type="range" class="range" min="4" max="12" step="0.5" value="${state.data.sleep}" oninput="state.data.sleep=this.value;db.saveSession();render()"><div style="display:flex;justify-content:space-between;font-size:.875rem;color:#6b7280;margin-top:8px"><span>4h</span><span>12h</span></div><label class="label" style="margin-top:24px">Estresse (1-10): <strong style="color:#2563eb;font-size:1.25rem">${state.data.stress}/10</strong></label><input type="range" class="range" min="1" max="10" value="${state.data.stress}" oninput="state.data.stress=this.value;db.saveSession();render()"><div style="display:flex;justify-content:space-between;font-size:.875rem;color:#6b7280;margin-top:8px"><span>1 (Baixo)</span><span>10 (Alto)</span></div>`;else if(state.step===3)c.innerHTML=`<h3 style="font-weight:700;font-size:1.5rem;margin-bottom:24px">ğŸƒ Atividade FÃ­sica</h3><label class="label">ExercÃ­cio: <strong style="color:#2563eb;font-size:1.25rem">${state.data.exercise} dias/semana</strong></label><input type="range" class="range" min="0" max="7" value="${state.data.exercise}" oninput="state.data.exercise=this.value;db.saveSession();render()"><label class="label" style="margin-top:24px">AlimentaÃ§Ã£o</label><select class="input" onchange="state.data.diet=this.value;db.saveSession()"><option value="healthy" ${state.data.diet==='healthy'?'selected':''}>ğŸ¥— SaudÃ¡vel</option><option value="balanced" ${state.data.diet==='balanced'?'selected':''}>âš–ï¸ Equilibrada</option><option value="poor" ${state.data.diet==='poor'?'selected':''}>ğŸ” Precisa melhorar</option></select>`;else if(state.step===4)c.innerHTML=`<h3 style="font-weight:700;font-size:1.5rem;margin-bottom:24px">ğŸš­ HÃ¡bitos</h3><label class="label">VocÃª fuma?</label><div class="grid grid-2"><button type="button" class="btn ${state.data.smoking==='no'?'btn-success':'btn-secondary'}" onclick="state.data.smoking='no';db.saveSession();render()">âœ… NÃ£o</button><button type="button" class="btn ${state.data.smoking==='yes'?'btn-primary':'btn-secondary'}" style="${state.data.smoking==='yes'?'background:#ef4444;color:white':''}" onclick="state.data.smoking='yes';db.saveSession();render()">âŒ Sim</button></div><label class="label" style="margin-top:24px">Ãlcool</label><select class="input" onchange="state.data.alcohol=this.value;db.saveSession()"><option value="none" ${state.data.alcohol==='none'?'selected':''}>ğŸš« NÃ£o bebo</option><option value="moderate" ${state.data.alcohol==='moderate'?'selected':''}>ğŸ· Socialmente</option><option value="heavy" ${state.data.alcohol==='heavy'?'selected':''}>ğŸº Frequentemente</option></select><label class="label" style="margin-top:24px">Tela: <strong style="color:#2563eb;font-size:1.25rem">${state.data.screenTime}h/dia</strong></label><input type="range" class="range" min="1" max="16" value="${state.data.screenTime}" oninput="state.data.screenTime=this.value;db.saveSession();render()">`}
function prevStep(){if(state.step>1){state.step--;db.saveSession();render()}else setPage(state.user?'dash':'login')}
function nextStep(){if(state.step<4){state.step++;db.saveSession();render()}else{state.life=calcLife(state.data);db.saveSession();setPage('dash');toast('AnÃ¡lise concluÃ­da!','success')}}
function renderDash(){if(!state.life)return;if(countdownInterval)clearInterval(countdownInterval);const yearsLeft=state.life.exp-parseInt(state.data.age);countdownInterval=setInterval(()=>{const el=document.getElementById('countdown');if(!el){clearInterval(countdownInterval);return}const now=new Date(),end=new Date(now.getFullYear()+yearsLeft,now.getMonth(),now.getDate()),diff=end-now;if(diff<0){el.innerHTML='<div style="color:#fecaca;font-weight:700">Tempo esgotado</div>';clearInterval(countdownInterval);return}const y=Math.floor(diff/(1000*60*60*24*365)),d=Math.floor((diff%(1000*60*60*24*365))/(1000*60*60*24)),h=Math.floor((diff%(1000*60*60*24))/(1000*60*60)),m=Math.floor((diff%(1000*60*60))/(1000*60)),s=Math.floor((diff%(1000*60))/1000);el.innerHTML=`<div style="display:grid;grid-template-columns:repeat(5,1fr);gap:12px"><div style="text-align:center"><div style="font-size:1.75rem;font-weight:800">${y}</div><div style="opacity:.8">Anos</div></div><div style="text-align:center"><div style="font-size:1.75rem;font-weight:800">${d}</div><div style="opacity:.8">Dias</div></div><div style="text-align:center"><div style="font-size:1.75rem;font-weight:800">${h}</div><div style="opacity:.8">Horas</div></div><div style="text-align:center"><div style="font-size:1.75rem;font-weight:800">${m}</div><div style="opacity:.8">Min</div></div><div style="text-align:center"><div style="font-size:1.75rem;font-weight:800">${s}</div><div style="opacity:.8">Seg</div></div></div>`},1000);const factors=document.getElementById('factors');if(factors)factors.innerHTML=state.life.factors.map(f=>`<div style="background:#f9fafb;padding:16px;border-radius:12px;border-left:4px solid ${f.i>0?'#10b981':'#ef4444'};margin-bottom:12px"><div style="display:flex;justify-content:space-between;align-items:start;gap:16px"><div style="flex:1"><div style="font-weight:600;margin-bottom:4px">${f.h}</div><div style="font-size:.875rem;color:#6b7280">${f.r}</div></div><div style="font-weight:800;font-size:1.5rem;color:${f.i>0?'#10b981':'#ef4444'};white-space:nowrap">${f.i>0?'+':''}${f.i}</div></div></div>`).join('')}
function handleAuth(e){e.preventDefault();const email=document.getElementById('authEmail').value.trim(),pass=document.getElementById('authPass').value,name=document.getElementById('authName')?.value?.trim(),isReg=document.getElementById('nameField').style.display!=='none';if(isReg){if(!name){toast('Insira seu nome','error');return}const newUser={name,email,pass:btoa(pass),createdAt:Date.now()};db.saveUser(newUser);state.user=newUser;state.data.name=name;state.data.email=email;db.saveSession();setPage('quest');toast('Conta criada!','success')}else{const user=db.getUser(email);if(user&&user.pass===btoa(pass)){state.user=user;state.data.name=user.name;state.data.email=user.email;const saved=db.loadSession();if(saved&&saved.user&&saved.user.email===email){state=saved}db.saveSession();if(state.life)setPage('dash');else setPage('quest');toast('Login realizado!','success')}else{toast('Email/senha incorretos','error')}}}
function logout(){if(confirm('Sair?')){if(countdownInterval)clearInterval(countdownInterval);db.clearSession();state={page:'landing',user:null,data:{name:'',email:'',age:'',gender:'',sleep:'7',exercise:'3',diet:'balanced',smoking:'no',alcohol:'moderate',stress:'5',screenTime:'4'},life:null,step:1};render();toast('Logout realizado','info')}}
function openEditHabits(){const m=document.createElement('div');m.className='modal';m.id='editModal';m.innerHTML=`<div class="modal-content animate-fade"><div class="modal-header"><h2 style="font-weight:800;font-size:1.75rem">âœï¸ Atualizar Meus HÃ¡bitos</h2><button class="modal-close" onclick="document.getElementById('editModal').remove()">Ã—</button></div><div class="modal-body"><div id="editContent"></div><button class="btn btn-success" style="width:100%;margin-top:24px" onclick="saveEditHabits()">ğŸ’¾ Salvar AlteraÃ§Ãµes</button></div></div>`;document.body.appendChild(m);renderEditHabits()}
function renderEditHabits(){document.getElementById('editContent').innerHTML=`<label class="label">ğŸ˜´ Sono: <strong style="color:#2563eb">${state.data.sleep}h</strong></label><input type="range" class="range" min="4" max="12" step="0.5" value="${state.data.sleep}" oninput="state.data.sleep=this.value;renderEditHabits()" style="margin-bottom:20px"><label class="label">ğŸƒ ExercÃ­cio: <strong style="color:#2563eb">${state.data.exercise} dias</strong></label><input type="range" class="range" min="0" max="7" value="${state.data.exercise}" oninput="state.data.exercise=this.value;renderEditHabits()" style="margin-bottom:20px"><label class="label">ğŸ¥— AlimentaÃ§Ã£o</label><select class="input" id="editDiet" onchange="state.data.diet=this.value"><option value="healthy" ${state.data.diet==='healthy'?'selected':''}>ğŸ¥— SaudÃ¡vel</option><option value="balanced" ${state.data.diet==='balanced'?'selected':''}>âš–ï¸ Equilibrada</option><option value="poor" ${state.data.diet==='poor'?'selected':''}>ğŸ” Precisa melhorar</option></select><label class="label">ğŸš­ Fumar</label><div class="grid grid-2" style="margin-bottom:20px"><button type="button" class="btn ${state.data.smoking==='no'?'btn-success':'btn-secondary'}" onclick="state.data.smoking='no';renderEditHabits()">âœ… NÃ£o</button><button type="button" class="btn ${state.data.smoking==='yes'?'btn-primary':'btn-secondary'}" style="${state.data.smoking==='yes'?'background:#ef4444;color:white':''}" onclick="state.data.smoking='yes';renderEditHabits()">âŒ Sim</button></div><label class="label">ğŸ· Ãlcool</label><select class="input" id="editAlcohol" onchange="state.data.alcohol=this.value"><option value="none" ${state.data.alcohol==='none'?'selected':''}>ğŸš« NÃ£o bebo</option><option value="moderate" ${state.data.alcohol==='moderate'?'selected':''}>ğŸ· Socialmente</option><option value="heavy" ${state.data.alcohol==='heavy'?'selected':''}>ğŸº Frequentemente</option></select><label class="label">ğŸ˜° Estresse: <strong style="color:#2563eb">${state.data.stress}/10</strong></label><input type="range" class="range" min="1" max="10" value="${state.data.stress}" oninput="state.data.stress=this.value;renderEditHabits()" style="margin-bottom:20px"><label class="label">ğŸ“± Tela: <strong style="color:#2563eb">${state.data.screenTime}h</strong></label><input type="range" class="range" min="1" max="16" value="${state.data.screenTime}" oninput="state.data.screenTime=this.value;renderEditHabits()">`}
function saveEditHabits(){if(countdownInterval)clearInterval(countdownInterval);state.life=calcLife(state.data);db.saveSession();document.getElementById('editModal').remove();toast('HÃ¡bitos atualizados!','success');render()}
function openSimulator(){let simData={...state.data};const m=document.createElement('div');m.className='modal';m.id='simModal';m.innerHTML=`<div class="modal-content animate-fade"><div class="modal-header"><h2 style="font-weight:800;font-size:1.75rem">ğŸ”„ Simulador de MudanÃ§as</h2><button class="modal-close" onclick="document.getElementById('simModal').remove()">Ã—</button></div><div class="modal-body"><div style="background:#eff6ff;padding:16px;border-radius:12px;margin-bottom:20px;border:2px solid #2563eb"><p style="font-size:.9rem;color:#1e40af;font-weight:600">ğŸ’¡ Ajuste os controles para ver o impacto nas suas expectativas!</p></div><div class="grid grid-2" style="margin-bottom:20px"><div class="card" style="background:linear-gradient(135deg,#2563eb,#7c3aed);color:white;padding:20px"><h3 style="font-weight:700;margin-bottom:8px">Atual</h3><div style="font-size:3rem;font-weight:800">${state.life.exp}</div><div style="opacity:.9">anos</div></div><div class="card" style="background:linear-gradient(135deg,#10b981,#14b8a6);color:white;padding:20px"><h3 style="font-weight:700;margin-bottom:8px">Simulado</h3><div style="font-size:3rem;font-weight:800" id="simLife">${state.life.exp}</div><div style="opacity:.9">anos</div><div id="simDiff" style="font-size:1.5rem;font-weight:700;margin-top:8px"></div></div></div><div id="simControls"></div><div id="simResult" style="margin-top:20px"></div><button class="btn btn-primary" style="width:100%;margin-top:20px" onclick="document.getElementById('simModal').remove()">Fechar Simulador</button></div></div>`;document.body.appendChild(m);const updateSim=()=>{const r=calcLife(simData),diff=r.exp-state.life.exp;document.getElementById('simLife').textContent=r.exp;const diffEl=document.getElementById('simDiff');if(diff>0)diffEl.innerHTML=`ğŸ‰ +${diff} anos`;else if(diff<0)diffEl.innerHTML=`âš ï¸ ${diff} anos`;else diffEl.innerHTML='';const resultEl=document.getElementById('simResult');if(diff>0)resultEl.innerHTML=`<div style="background:#d1fae5;border:2px solid #10b981;padding:16px;border-radius:12px"><h3 style="font-weight:800;color:#065f46;margin-bottom:8px">ğŸ‰ Excelente!</h3><p style="color:#047857">VocÃª pode ganhar <strong>${diff} anos</strong> (${(diff*365).toLocaleString()} dias extras)!</p></div>`;else if(diff<0)resultEl.innerHTML=`<div style="background:#fee2e2;border:2px solid #ef4444;padding:16px;border-radius:12px"><h3 style="font-weight:800;color:#991b1b;margin-bottom:8px">âš ï¸ AtenÃ§Ã£o</h3><p style="color:#b91c1c">Pode reduzir <strong>${Math.abs(diff)} anos</strong>. Escolha hÃ¡bitos melhores!</p></div>`;else resultEl.innerHTML='';document.getElementById('simControls').innerHTML=`<div style="background:#f9fafb;padding:16px;border-radius:12px"><label class="label">ğŸ˜´ Sono: <strong style="color:#2563eb" id="simSleepVal">${simData.sleep}h</strong></label><input type="range" class="range" min="4" max="12" step="0.5" value="${simData.sleep}" oninput="simData.sleep=this.value;document.getElementById('simSleepVal').textContent=this.value+'h';updateSim()" style="margin-bottom:16px"><label class="label">ğŸƒ ExercÃ­cio: <strong style="color:#2563eb" id="simExVal">${simData.exercise} dias</strong></label><input type="range" class="range" min="0" max="7" value="${simData.exercise}" oninput="simData.exercise=this.value;document.getElementById('simExVal').textContent=this.value+' dias';updateSim()" style="margin-bottom:16px"><label class="label">ğŸ¥— AlimentaÃ§Ã£o: <strong style="color:#2563eb" id="simDietLabel">${simData.diet==='healthy'?'SaudÃ¡vel':simData.diet==='poor'?'Precisa melhorar':'Equilibrada'}</strong></label><select class="input" onchange="simData.diet=this.value;const opts={healthy:'SaudÃ¡vel',balanced:'Equilibrada',poor:'Precisa melhorar'};document.getElementById('simDietLabel').textContent=opts[this.value];updateSim()" style="margin-bottom:16px"><option value="healthy" ${simData.diet==='healthy'?'selected':''}>ğŸ¥— SaudÃ¡vel</option><option value="balanced" ${simData.diet==='balanced'?'selected':''}>âš–ï¸ Equilibrada</option><option value="poor" ${simData.diet==='poor'?'selected':''}>ğŸ” Precisa melhorar</option></select><label class="label">ğŸš­ Fumar</label><div class="grid grid-2" style="margin-bottom:16px"><button type="button" class="btn ${simData.smoking==='no'?'btn-success':'btn-secondary'}" onclick="simData.smoking='no';updateSim();renderSimControls()">âœ… NÃ£o</button><button type="button" class="btn ${simData.smoking==='yes'?'btn-primary':'btn-secondary'}" onclick="simData.smoking='yes';updateSim();renderSimControls()" style="${simData.smoking==='yes'?'background:#ef4444;color:white':''}">âŒ Sim</button></div><label class="label">ğŸ· Ãlcool: <strong style="color:#2563eb" id="simAlcoholLabel">${simData.alcohol==='none'?'NÃ£o bebo':simData.alcohol==='heavy'?'Frequentemente':'Socialmente'}</strong></label><select class="input" onchange="simData.alcohol=this.value;const opts={none:'NÃ£o bebo',moderate:'Socialmente',heavy:'Frequentemente'};document.getElementById('simAlcoholLabel').textContent=opts[this.value];updateSim()" style="margin-bottom:16px"><option value="none" ${simData.alcohol==='none'?'selected':''}>ğŸš« NÃ£o bebo</option><option value="moderate" ${simData.alcohol==='moderate'?'selected':''}>ğŸ· Socialmente</option><option value="heavy" ${simData.alcohol==='heavy'?'selected':''}>ğŸº Frequentemente</option></select><label class="label">ğŸ˜° Estresse: <strong style="color:#2563eb" id="simStressVal">${simData.stress}/10</strong></label><input type="range" class="range" min="1" max="10" value="${simData.stress}" oninput="simData.stress=this.value;document.getElementById('simStressVal').textContent=this.value+'/10';updateSim()"></div>`;function renderSimControls(){const btns=document.querySelectorAll('#simControls button');btns[0].className=`btn ${simData.smoking==='no'?'btn-success':'btn-secondary'}`;btns[1].className=`btn ${simData.smoking==='yes'?'btn-primary':'btn-secondary'}`;btns[1].style.cssText=simData.smoking==='yes'?'background:#ef4444;color:white':''}};updateSim()}
function toggleChat(){document.getElementById('chatWindow').classList.toggle('hidden')}
const chatResponses={'ola':'OlÃ¡! ğŸ‘‹ Digite "ajuda" para ver todos os tÃ³picos que posso te ajudar!','oi':'Oi! ğŸ˜Š Digite "ajuda" para ver como posso te auxiliar com saÃºde e longevidade!','sono':'Dormir 7-8h por noite Ã© essencial! Falta de sono pode reduzir atÃ© 5 anos de vida. EstabeleÃ§a horÃ¡rios regulares e evite telas antes de dormir.','exercicio':'A OMS recomenda 150min/semana de atividade moderada. Comece devagar: 30min de caminhada 3x/semana jÃ¡ faz diferenÃ§a!','exercÃ­cio':'A OMS recomenda 150min/semana de atividade moderada. Comece devagar: 30min de caminhada 3x/semana jÃ¡ faz diferenÃ§a!','dieta':'Dieta balanceada com frutas, vegetais, proteÃ­nas magras e grÃ£os integrais pode adicionar 3 anos! Reduza processados e aÃ§Ãºcar.','fumar':'Parar de fumar Ã© a melhor decisÃ£o para sua saÃºde! Pode aumentar sua expectativa em atÃ© 10 anos. Busque ajuda mÃ©dica ou grupos de apoio.','tabaco':'Parar de fumar Ã© a melhor decisÃ£o! O tabagismo reduz atÃ© 10 anos de vida. Existem tratamentos e grupos de apoio que funcionam.','tabagismo':'O tabagismo Ã© a principal causa evitÃ¡vel de morte no mundo. Parar pode adicionar atÃ© 10 anos Ã  sua vida! Converse com seu mÃ©dico.','cigarro':'Largar o cigarro adiciona atÃ© 10 anos de vida! Mesmo depois de anos fumando, seu corpo se recupera. Busque ajuda profissional.','estresse':'Estresse crÃ´nico reduz atÃ© 4 anos de vida. Pratique: meditaÃ§Ã£o 10min/dia, yoga, exercÃ­cios de respiraÃ§Ã£o, caminhadas na natureza.','stress':'Estresse alto prejudica coraÃ§Ã£o e imunidade. Pratique mindfulness, exercÃ­cios, hobbies relaxantes. Considere terapia se persistir.','tela':'Mais de 8h/dia em telas pode reduzir 2 anos. FaÃ§a pausas a cada hora (regra 20-20-20), use filtro azul Ã  noite, desligue 1h antes de dormir.','ajuda':'ğŸ“‹ Posso ajudar com:\n\nğŸ”¹ Sono e descanso\nğŸ”¹ ExercÃ­cio fÃ­sico\nğŸ”¹ Dieta e alimentaÃ§Ã£o\nğŸ”¹ Tabagismo/Fumar/Cigarro\nğŸ”¹ Estresse\nğŸ”¹ Tempo de tela\nğŸ”¹ Ãlcool\nğŸ”¹ Brasil (dados de saÃºde)\nğŸ”¹ Expectativa de vida\nğŸ”¹ Simulador\nğŸ”¹ Atualizar hÃ¡bitos\nğŸ”¹ Clima\n\nDigite qualquer palavra-chave!','brasil':'No Brasil, a expectativa mÃ©dia Ã© 76.6 anos. Principais causas de morte: cardiovasculares (30%), cÃ¢ncer (17%), diabetes (5%). HÃ¡bitos saudÃ¡veis fazem diferenÃ§a!','expectativa':'Sua expectativa Ã© calculada com idade, sexo e 8 fatores de hÃ¡bitos. Cada mudanÃ§a positiva adiciona anos! Use o simulador para testar.','simulador':'O simulador mostra quantos anos vocÃª pode ganhar ou perder mudando hÃ¡bitos. Experimente melhorar sono, exercÃ­cio e parar de fumar para ver o impacto!','atualizar':'Use o botÃ£o "âœï¸ Atualizar HÃ¡bitos" no dashboard para editar seus dados atuais e recalcular sua expectativa de vida!','editar':'No dashboard, clique em "Atualizar HÃ¡bitos" para modificar seu perfil atual e ver como suas mudanÃ§as afetam sua longevidade.','alcool':'Ãlcool excessivo reduz 5 anos de vida. O ideal Ã© limite de 1-2 doses, 2x/semana no mÃ¡ximo. NÃ£o beber adiciona 2 anos!','Ã¡lcool':'Consumo moderado: atÃ© 2x/semana. Consumo pesado reduz 5 anos e aumenta risco de doenÃ§as hepÃ¡ticas e cÃ¢ncer.','tempo':'${weather?`Em ${weather.city}: ${weather.temp}Â°C, ${weather.desc}. Umidade: ${weather.humidity}%. Bom dia para atividades ao ar livre! ğŸŒ¤ï¸`:`Desculpe, nÃ£o consegui obter dados do clima no momento. Tente novamente!`}','clima':'${weather?`Clima atual em ${weather.city}: ${weather.temp}Â°C, ${weather.desc}. Aproveite o dia! â˜€ï¸`:`NÃ£o consegui dados do clima. Verifique sua conexÃ£o!`}','previsao':'${weather?`Agora em ${weather.city}: ${weather.temp}Â°C, ${weather.desc}. Temperatura agradÃ¡vel! ğŸŒ¡ï¸`:`Dados de clima indisponÃ­veis no momento.`}','temperatura':'${weather?`A temperatura atual em ${weather.city} Ã© ${weather.temp}Â°C com ${weather.desc.toLowerCase()}.`:`NÃ£o foi possÃ­vel obter temperatura.`}'};
const notUnderstood=['Hmm, nÃ£o entendi bem. Digite "ajuda" para ver o que posso responder! ğŸ¤”','Desculpe, nÃ£o compreendi. Que tal digitar "ajuda" para ver os tÃ³picos disponÃ­veis? ğŸ’¬','NÃ£o reconheci essa pergunta. Digite "ajuda" para ver como posso te auxiliar! ğŸ†˜','Ops! NÃ£o entendi. Experimente "ajuda" para ver todos os comandos! â“','NÃ£o consegui processar isso. Digite "ajuda" para ver o que posso fazer por vocÃª! ğŸ”'];
function sendChat(){const inp=document.getElementById('chatInput'),msg=inp.value.trim();if(!msg)return;const msgs=document.getElementById('chatMsgs');msgs.innerHTML+=`<div class="chat-msg chat-user">${msg}</div>`;inp.value='';let resp=null;for(const[k,v]of Object.entries(chatResponses)){if(msg.toLowerCase().includes(k)){resp=eval('`'+v+'`');break}}if(!resp)resp=notUnderstood[Math.floor(Math.random()*notUnderstood.length)];setTimeout(()=>{msgs.innerHTML+=`<div class="chat-msg chat-bot">${resp}</div>`;msgs.scrollTop=msgs.scrollHeight},500)}
window.onload=async()=>{await fetchWeather();const saved=db.loadSession();if(saved&&saved.user){state=saved;if(state.life){setPage('dash')}else{setPage('quest')}}else{setPage('landing')}};
render();
</script>
</body>
</html>
